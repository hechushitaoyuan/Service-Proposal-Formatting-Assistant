<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>建筑项目展示系统</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/templates_document.css" id="templateCSS" data-format="text">
</head>
<body>
    <div class="app-container">
        <!-- 左侧控制面板 -->
        <div class="left-panel">
            <div class="panel-logo">
                <img src="LOGO.svg" alt="服务建议书排版助手" class="app-logo">
            </div>
            <!-- 项目工程选择 -->
            <div class="section">
                <h3>项目工程</h3>
                <select id="projectSelect" class="project-select">
                    <option value="">请选择</option>
                </select>
            </div>

            <!-- 属性选择 -->
            <div class="section">
                <h3>属性选择</h3>
                <div class="attribute-grid">
                    <label class="checkbox-item">
                        <input type="checkbox" id="attr-type" value="项目类型" data-key="BB">
                        <span>项目类型</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="attr-area" value="建筑面积" data-key="CC">
                        <span>建筑面积</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="attr-height" value="建筑高度" data-key="DD">
                        <span>建筑高度</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="attr-time" value="设计时间" data-key="HH">
                        <span>设计时间</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="attr-cost" value="工程造价" data-key="EE">
                        <span>工程造价</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="attr-partner" value="合作单位" data-key="GG">
                        <span>合作单位</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="attr-location" value="建设地点" data-key="FF">
                        <span>建设地点</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="attr-award" value="获奖名称" data-key="II">
                        <span>获奖名称</span>
                    </label>
                </div>
            </div>

            <!-- 项目照片 -->
            <div class="section project-photos-section">
                <h3>项目照片</h3>
                <div id="projectImages" class="image-grid">
                    <!-- 动态加载项目图片 -->
                </div>
            </div>
        </div>

        <!-- 右侧模板预览区域 -->
        <div class="right-panel">
            <div class="preview-section">
                <div class="preview-header">
                    <div class="preview-title-section">
                        <h3>模板预览</h3>
                        <div class="format-toggle-container">
                            <div class="format-slider-track" id="formatSliderTrack">
                                <div class="format-slider-button" id="formatSliderButton">
                                    <span class="format-slider-text" id="formatSliderText">文本格式</span>
                                </div>
                                <div class="format-position format-position-left" data-format="text">文本格式</div>
                                <div class="format-position format-position-center" data-format="report">汇报格式</div>
                                <div class="format-position format-position-right" data-format="board">展板格式</div>
                            </div>
                        </div>
                    </div>
                    <div class="preview-controls">
                        <div class="language-control">
                            <button id="languageToggle" class="language-toggle" title="切换语言">中文</button>
                        </div>
                        <div class="zoom-control">
                            <label for="zoomSlider">缩放:</label>
                            <input type="range" id="zoomSlider" class="zoom-slider" min="0.1" max="1" step="0.05" value="0.80">
                            <span id="zoomValue" class="zoom-value">80%</span>
                        </div>
                        <div class="action-buttons">
                            <button id="downloadBtn" class="download-btn">下载单页</button>
                            <button id="presetBtn" class="preset-btn">预存</button>
                            <button id="presetSpaceBtn" class="preset-space-btn">预存空间</button>
                        </div>
                        <div class="preset-dropdown" id="presetDropdown">
                            <div class="preset-dropdown-header">
                                <span>预存空间</span>
                                <button class="preset-close-btn" id="presetCloseBtn">&times;</button>
                            </div>
                            <div class="preset-list" id="presetList">
                                <div class="preset-empty">暂无预存页面</div>
                            </div>
                            <div class="preset-actions">
                                <div class="download-options">
                                    <label for="downloadFormatSelect">导出格式</label>
                                    <select id="downloadFormatSelect" class="download-format-select">
                                        <option value="html">HTML</option>
                                        <option value="ppt">PPT</option>
                                        <option value="pdf">PDF</option>
                                    </select>
                                </div>
                                <div class="preset-action-buttons">
                                    <button id="clearAllPresetsBtn" class="preset-action-btn clear-btn">清空全部</button>
                                    <button id="downloadAllPresetsBtn" class="preset-action-btn download-all-btn">开始导出</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 预览面板 -->
                <div id="previewPanel" class="preview-panel">
                    <div class="template-container" id="templateContainer">
                        <!-- 模板内容将动态加载到这里 -->
                        <div class="template-placeholder">
                            <p>请选择项目和模板开始预览</p>
                        </div>
                    </div>
                </div>

                <!-- 模板缩略图选择器 -->
                <div class="template-selector">
                    <div class="template-thumbnails">
                        <div class="thumbnail-item" data-template="1">
                            <img src="thumbnail/01 document/document_1.jpg" alt="模板1">
                            <span>模板1</span>
                        </div>
                        <div class="thumbnail-item" data-template="2">
                            <img src="thumbnail/01 document/document_2.jpg" alt="模板2">
                            <span>模板2</span>
                        </div>
                        <div class="thumbnail-item" data-template="3">
                            <img src="thumbnail/01 document/document_3.jpg" alt="模板3">
                            <span>模板3</span>
                        </div>
                        <div class="thumbnail-item" data-template="4">
                            <img src="thumbnail/01 document/document_4.jpg" alt="模板4">
                            <span>模板4</span>
                        </div>
                        <div class="thumbnail-item" data-template="5">
                            <img src="thumbnail/01 document/document_5.jpg" alt="模板5">
                            <span>模板5</span>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
    </div>

    <!-- 加载提示 -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p>正在加载...</p>
    </div>

    <!-- 导出渲染容器（隐藏） -->
    <div id="exportRenderContainer" class="export-render-container" aria-hidden="true"></div>

    <!-- 脚本文件 -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="js/data-loader.js"></script>
    <script src="js/template-manager.js"></script>
    <script src="js/drag-drop.js"></script>
    <script src="js/preset-manager.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
